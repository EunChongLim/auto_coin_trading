# 🚀 비트코인 자동매매 모델 재설계 계획

## 📊 현재까지의 문제점 분석

### 시도한 전략들:

1. **규칙 기반 (볼린저밴드)**: -0.44% (최선)
2. **ML 하이브리드**: -0.72%
3. **승률**: 30~40% (너무 낮음)
4. **거래 빈도**: 7~14회/일

### 핵심 문제:

- **낮은 승률**: 예측 정확도 부족
- **라벨 불균형**: 상승 20% vs 하락 80% (불균형 여전히 존재)
- **노이즈**: 1분봉에도 노이즈가 많음
- **특징 부족**: 가격/거래량 기반 특징만으로 한계

---

## 🎯 새로운 접근 방식

### 1️⃣ 멀티 타임프레임 특징 (다중 시간 분석)

**핵심 아이디어**: 1분봉만 보지 말고 5분, 15분, 1시간 추세를 함께 고려

```python
특징 추가:
- 1분봉: 현재 캔들 정보 (RSI, BB, Volume)
- 5분봉: 단기 추세 (이동평균, MACD)
- 15분봉: 중기 추세 (추세 방향)
- 1시간봉: 장기 추세 (지지/저항)

→ 여러 시간대의 정보를 종합하여 더 정확한 예측
```

### 2️⃣ 라벨 재정의 (3-Class Classification)

**기존**: 이진 분류 (상승 vs 하락)
**새로운**: 3-class 분류

```python
라벨:
- 0: 하락 (향후 20분 내 -0.3% 이상 하락)
- 1: 횡보 (±0.3% 이내)
- 2: 상승 (향후 20분 내 +0.5% 이상 상승)

매매 전략:
- 2 (상승) 예측 → 매수
- 0 (하락) 예측 → 매도/대기
- 1 (횡보) 예측 → 홀드
```

### 3️⃣ 고급 특징 엔지니어링

```python
새로운 특징:
1. 시장 구조 특징
   - 최근 N분간 고점/저점 개수
   - 가격 변동성 (ATR)
   - 캔들 패턴 (Doji, Hammer 등)

2. 주문서 모방 특징
   - 가격 가속도 (2차 미분)
   - 거래량 프로파일
   - 체결강도 proxy

3. 시간 특징 강화
   - 시간대별 패턴 (아침/점심/저녁)
   - 요일 효과
   - 주요 시간대 (미국/한국 개장)

4. 상대적 특징
   - 현재가 vs 1시간 최고/최저 비율
   - RSI 상대 순위
   - 거래량 상대 순위
```

### 4️⃣ 앙상블 모델

**단일 모델 대신 여러 모델 조합**

```python
모델 1: LightGBM (빠른 트리 기반)
모델 2: XGBoost (강력한 부스팅)
모델 3: CatBoost (범주형 특징 강화)
모델 4: 규칙 기반 (볼린저밴드) - 보험

최종 예측 = 투표 or 가중평균
```

### 5️⃣ 시퀀스 모델 (LSTM/Transformer)

**시계열 특성 활용**

```python
입력: 최근 60개 1분봉 (1시간)
출력: 향후 20분 가격 움직임

LSTM/Transformer가 시퀀스 패턴 학습
→ 단순 특징보다 시간적 패턴 포착
```

---

## 🛠️ 구현 우선순위

### Phase 1: 멀티 타임프레임 + 3-Class (추천) ⭐⭐⭐

- **장점**: 구현 쉬움, 성능 개선 기대
- **시간**: 30분
- **기대효과**: 승률 40~50% 목표

### Phase 2: 고급 특징 추가

- **장점**: 더 많은 정보 제공
- **시간**: 1시간
- **기대효과**: 승률 45~55% 목표

### Phase 3: 앙상블

- **장점**: 안정적 성능
- **시간**: 1시간
- **기대효과**: 승률 50~60% 목표

### Phase 4: LSTM/Transformer (선택)

- **장점**: 최신 딥러닝 기술
- **시간**: 2~3시간
- **기대효과**: 승률 55~65% 목표
- **단점**: 복잡도 높음, 오버피팅 위험

---

## 🎯 추천 진행 순서

1. **Phase 1 구현** (멀티 타임프레임 + 3-Class)
2. 백테스팅으로 검증
3. 성능 향상 확인 시 → Phase 2
4. 성능 미달 시 → Phase 4 고려

---

## 💡 예상 결과

- **Phase 1 후**: 승률 40~50%, 수익률 +0.5~1.0%
- **Phase 2 후**: 승률 45~55%, 수익률 +1.0~2.0%
- **Phase 3 후**: 승률 50~60%, 수익률 +2.0~3.0%

---

## ⚠️ 주의사항

1. **과적합 방지**: Walk-Forward 검증 필수
2. **실전 테스트**: 소액으로 검증
3. **파라미터 튜닝**: 손익비 계속 최적화
4. **시장 상황**: 상승장/하락장별 성능 차이 확인
